{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_ordemAtual","_service","NegociacaoService","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","apaga","esvazia","importa","coluna","inverteOrdem","ordena","a","b","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\n\n  constructor() {\n    let $ = document.querySelector.bind( document ); // Keep association with document\n\n    this._inputData       = $( '#data' );\n    this._inputQuantidade = $( '#quantidade' );\n    this._inputValor      = $( '#valor' );\n\n    this._listaNegociacoes = new Bind(\n      new ListaNegociacoes(),\n      new NegociacoesView( $( '#negociacoesView' ) ),\n      'adiciona', 'esvazia', 'ordena', 'inverteOrdem'\n    );\n\n    this._mensagem = new Bind(\n      new Mensagem(),\n      new MensagemView( $( '#mensagemView' ) ),\n      'texto'\n    );\n\n    this._ordemAtual = '';\n    this._service    = new NegociacaoService();\n\n    this._init();\n  }\n\n  _init() {\n\n    this._service\n      .lista()\n      .then( negociacoes =>\n        negociacoes.forEach( negociacao =>\n          this._listaNegociacoes.adiciona( negociacao )\n        )\n      )\n      .catch( erro => this._mensagem.texto = erro );\n  }\n\n  adiciona( event ) {\n    event.preventDefault();\n\n    let negociacao = this._criaNegociacao();\n\n    this._service\n      .cadastra( negociacao )\n      .then( mensagem => {\n        this._listaNegociacoes.adiciona( negociacao );\n        this._mensagem.texto = mensagem;\n        this._limpaFormulario();\n      })\n      .catch( erro => this._mensagem.texto = erro );\n  }\n\n  apaga() {\n\n    this._service\n      .apaga()\n      .then( mensagem => {\n        this._listaNegociacoes.esvazia();\n        this._mensagem.texto = mensagem;\n      })\n      .catch( erro => this._mensagem.texto = erro );\n\n  }\n\n  importaNegociacoes() {\n\n    this._service\n      .importa( this._listaNegociacoes.negociacoes )\n      .then( negociacoes => {\n        negociacoes.forEach( negociacao => this._listaNegociacoes.adiciona( negociacao ) );\n        this._mensagem.texto = 'Negociações importadas com sucesso';\n      })\n      .catch( erro => this._mensagem.texto = erro );\n\n  }\n\n  ordena( coluna ) {\n    if ( this._ordemAtual == coluna ) {\n      this._listaNegociacoes.inverteOrdem();\n    } else {\n      this._listaNegociacoes.ordena( ( a, b ) => a[ coluna ] - b[ coluna ] );\n    }\n    this._ordemAtual = coluna;\n  }\n\n  _criaNegociacao() {\n    return new Negociacao(\n      DateHelper.textoParaData( this._inputData.value ),\n      parseInt(this._inputQuantidade.value),\n      parseFloat(this._inputValor.value)\n    );\n  }\n\n  _limpaFormulario() {\n    this._inputData.value = '';\n    this._inputQuantidade.value = 1;\n    this._inputValor.value = 0.0;\n\n    this._inputData.focus();\n  }\n}\n"]}
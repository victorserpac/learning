{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","Negociacao","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_ordemAtual","_service","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","apaga","esvazia","importa","coluna","inverteOrdem","ordena","a","b","textoParaData","value","parseInt","parseFloat","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import { ListaNegociacoes } from '../models/ListaNegociacoes';\nimport { Mensagem } from '../models/Mensagem';\nimport { NegociacoesView } from '../views/NegociacoesView';\nimport { MensagemView } from '../views/MensagemView';\nimport { NegociacaoService } from '../services/NegociacaoService';\nimport { DateHelper } from '../helpers/DateHelper';\nimport { Bind } from '../helpers/Bind';\nimport { Negociacao } from '../models/Negociacao';\n\nexport class NegociacaoController {\n\n  constructor() {\n    let $ = document.querySelector.bind( document ); // Keep association with document\n\n    this._inputData       = $( '#data' );\n    this._inputQuantidade = $( '#quantidade' );\n    this._inputValor      = $( '#valor' );\n\n    this._listaNegociacoes = new Bind(\n      new ListaNegociacoes(),\n      new NegociacoesView( $( '#negociacoesView' ) ),\n      'adiciona', 'esvazia', 'ordena', 'inverteOrdem'\n    );\n\n    this._mensagem = new Bind(\n      new Mensagem(),\n      new MensagemView( $( '#mensagemView' ) ),\n      'texto'\n    );\n\n    this._ordemAtual = '';\n    this._service    = new NegociacaoService();\n\n    this._init();\n  }\n\n  _init() {\n\n    this._service\n      .lista()\n      .then( negociacoes =>\n        negociacoes.forEach( negociacao =>\n          this._listaNegociacoes.adiciona( negociacao )\n        )\n      )\n      .catch( erro => this._mensagem.texto = erro );\n  }\n\n  adiciona( event ) {\n    event.preventDefault();\n\n    let negociacao = this._criaNegociacao();\n\n    this._service\n      .cadastra( negociacao )\n      .then( mensagem => {\n        this._listaNegociacoes.adiciona( negociacao );\n        this._mensagem.texto = mensagem;\n        this._limpaFormulario();\n      })\n      .catch( erro => this._mensagem.texto = erro );\n  }\n\n  apaga() {\n\n    this._service\n      .apaga()\n      .then( mensagem => {\n        this._listaNegociacoes.esvazia();\n        this._mensagem.texto = mensagem;\n      })\n      .catch( erro => this._mensagem.texto = erro );\n\n  }\n\n  importaNegociacoes() {\n\n    this._service\n      .importa( this._listaNegociacoes.negociacoes )\n      .then( negociacoes => {\n        negociacoes.forEach( negociacao => this._listaNegociacoes.adiciona( negociacao ) );\n        this._mensagem.texto = 'Negociações importadas com sucesso';\n      })\n      .catch( erro => this._mensagem.texto = erro );\n\n  }\n\n  ordena( coluna ) {\n    if ( this._ordemAtual == coluna ) {\n      this._listaNegociacoes.inverteOrdem();\n    } else {\n      this._listaNegociacoes.ordena( ( a, b ) => a[ coluna ] - b[ coluna ] );\n    }\n    this._ordemAtual = coluna;\n  }\n\n  _criaNegociacao() {\n    return new Negociacao(\n      DateHelper.textoParaData( this._inputData.value ),\n      parseInt(this._inputQuantidade.value),\n      parseFloat(this._inputValor.value)\n    );\n  }\n\n  _limpaFormulario() {\n    this._inputData.value = '';\n    this._inputQuantidade.value = 1;\n    this._inputValor.value = 0.0;\n\n    this._inputData.focus();\n  }\n}\n"]}